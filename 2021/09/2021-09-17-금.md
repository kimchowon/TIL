# JPA í•™ìŠµ í™˜ê²½ êµ¬ì„±í•´ë³´ê¸°(H2 ë°ì´í„°ë² ì´ìŠ¤, gradle ì„¤ì •)

í˜„ì¬ ìš°ë¦¬íŒ€ì—ì„œ ìš´ì˜í•˜ëŠ” í”„ë¡œì íŠ¸ë“¤ì˜ ORMì„ ì ì°¨ mybatisì—ì„œ JPAë¡œ ë³€ê²½í•˜ê³  ìˆë‹¤. 

ì™œ mybatisì—ì„œ JPAë¡œ ì˜®ê¸°ë ¤ê³  í•˜ëŠ”ê±¸ê¹Œ? JPAì˜ ì¥ì ì€ ë¬´ì—‡ì¼ê¹Œ?

JPAê°€ ë¬´ì—‡ì¸ì§€, mybatisì™€ ê°™ì€ íƒ€ ORMê³¼ ë¹„êµí•˜ì—¬ ì¥ì ì€ ë¬´ì—‡ì¸ì§€, ê·¸ë¦¬ê³  ì‚¬ìš© ë°©ë²•ê¹Œì§€ ê³µë¶€í•  ê²ƒì´ë‹¤.

ì˜¤ëŠ˜ì€ ë¡œì»¬ì—ì„œ ì‹¤ìŠµí•´ ë³¼ ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì„±í•´ë³´ë ¤ê³  í•œë‹¤. 

ê·¸ë¦¬ê³  JPAë¥¼ ì‚¬ìš©í•´ì„œ í•˜ë‚˜ì˜ í…Œì´ë¸”ì— ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ì¡°íšŒí•˜ëŠ” ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì–´ í™˜ê²½ì´ ì˜ êµ¬ì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸ê¹Œì§€ í•´ë³´ëŠ” ê²ƒì´ ì´ ì±•í„°ì˜ â­ï¸ëª©í‘œâ­ï¸ì´ë‹¤. 

## ğŸ’» ë‚˜ì˜ ë¡œì»¬ í™˜ê²½ ğŸ’»

- OS: Mac OS (Catalina 10.15.5 ver)
- Java JDK 1.8
- IDE: IntelliJ Community 2021.1ver (ë¬´ë£Œ ë²„ì „, Ultimateë©´ ì¢‹ê² ì§€ë§Œ.)

## ğŸ“•í•™ìŠµ ì„œì ğŸ“’

### ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¹€ì˜í•œ

<img src="https://user-images.githubusercontent.com/52793122/133824992-b3ec1f7a-3d1d-4125-867c-0fee75d96d81.png"  width="200" height="300"/>

ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ìŠµì„ í•˜ë˜ ì •ë§ ì±…ì— ë‚˜ì™€ìˆëŠ” ëª¨ë“  ë°©ë²•ì„ ê·¸ëŒ€~~ë¡œ ë”°ë¼í•˜ì§€ëŠ” ì•Šì•˜ë‹¤. 

ì˜ˆë¥¼ ë“¤ë©´ ì±…ì€ mavení™˜ê²½ìœ¼ë¡œ ì†Œê°œí•´ì£¼ê³  ìˆì§€ë§Œ ë‚˜ëŠ” gradle í™˜ê²½ìœ¼ë¡œ êµ¬ì„±í•˜ê³  ì„¸íŒ…í•  ì˜ˆì •ì´ë‹¤.  

ë˜í•œ ì±…ì— ë‚˜ì™€ìˆëŠ” ë°©ë²•ì„ ê·¸ëŒ€ë¡œ ë”°ë¼í–ˆì„ ë•Œ ëª¨ë“ ê²ƒì´ í•œë²ˆì— íœ™íœ™ ì„±ê³µí•˜ë©´ ì–¼ë§ˆë‚˜ ì¢‹ê² ëƒë§Œì€, ê·¸ë ‡ì§€ ì•Šì€ ê²ƒì´ ê°œë°œì¸ ê²ƒì„.. ë•Œë¬¸ì— ë‚´ê°€ ì„±ê³µí•˜ëŠ” ë°©ë²•ì„ ì ìš©ì‹œí‚¤ë©´ì„œ ì‹œì‘í•´ë³´ê² ë‹¤. 

## 1. gradle ì„¤ì •

IntelliJ community í™˜ê²½ìœ¼ë¡œ gradle í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í–ˆì„ ë•Œ gradleíŒŒì¼ì€ ì´ëŸ° ëª¨ìŠµì´ë‹¤. 

```jsx
plugins {
    id 'java'
}

group 'org.example'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
}

test {
    useJUnitPlatform()
}
```

ì•„ë˜ì™€ ê°™ì´ í”ŒëŸ¬ê·¸ì¸ë“¤ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•´ì¤¬ë‹¤.

â†“

```jsx
plugins {
    id 'org.springframework.boot' version '2.2.5.RELEASE' // ìŠ¤í”„ë§ë¶€íŠ¸ í”ŒëŸ¬ê·¸ì¸
    id 'io.spring.dependency-management' version '1.0.9.RELEASE' // ìŠ¤í”„ë§ ì˜ì¡´ì„± ê´€ë¦¬ í”ŒëŸ¬ê·¸ì¸
    id 'java'
}

group 'org.example'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
    implementation 'org.springframework.boot:spring-boot-starter-web'

    // jdbc
    implementation 'org.springframework.boot:spring-boot-starter-jdbc'

    // H2
    runtimeOnly 'com.h2database:h2'

    // hibernate
    implementation 'org.hibernate:hibernate-entitymanager:5.2.2.Final'
}

test {
    useJUnitPlatform()
}
```

- org.springframework.boot:spring-boot-starter-web
: ì±…ì—ëŠ” ì—†ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì§€ë§Œ H2 ë°ì´í„°ë² ì´ìŠ¤ ì›¹ ì½˜ì†”ì„ ë¸Œë¼ìš°ì €ì—ì„œ ë„ìš°ê¸° ìœ„í•´ ì¶”ê°€í–ˆë‹¤.
- org.springframework.boot:spring-boot-starter-jdbc
: ë§ˆì°¬ê°€ì§€ë¡œ ì±…ì—ëŠ” ì—†ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤. ê·¸ëŸ°ë° H2ë§Œ gradleì— ì¶”ê°€í•˜ëŠ” ê²½ìš° H2 ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì‹œ ì›¹ë¸Œë¼ìš°ì €ì—ì„œ ì˜¤ë¥˜ë¥¼ ë§Œë‚˜ê²Œ ë˜ì—ˆë‹¤. ë‚˜ë¥¼ í¬í•¨í•œ ë§ì€ ì‚¬ëŒë“¤ì´ ë§Œë‚˜ëŠ” ì˜¤ë¥˜ì¸ ê²ƒ ê°™ê³  jdbc ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ë©´ ì˜¤ë¥˜ê°€ í•´ê²°ëœë‹¤.
- com.h2database:h2
spring bootì—ì„œ H2 ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì¶”ê°€í•œë‹¤.
- org.hibernate:hibernate-entitymanager:5.2.2.Final
ì±… ì „ë°˜ì— ê±¸ì³ JPA êµ¬í˜„ì²´ë¡œ í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤. JPA êµ¬í˜„ì²´ë¡œ í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. 
- hibernate-core: í•˜ì´ë²„ë„¤ì´íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- hibernate-entitymanager: í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ JPA êµ¬í˜„ì²´ë¡œ ë™ì‘í•˜ë„ë¡ JPA í‘œì¤€ì„ êµ¬í˜„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ 
- hibernate-jpa-(version)-api: JPA íŠ¹ì • ë²„ì „ í‘œì¤€ APIë¥¼ ëª¨ì•„ë‘” ë¼ì´ë¸ŒëŸ¬ë¦¬

org.hibernate:hibernate-entitymanagerë¥¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì§€ì •í•˜ë©´ ìœ„ 3ê°œë„ í•¨ê»˜ ë‚´ë ¤ë°›ì„ ìˆ˜ ìˆë‹¤.

## 2. application.yml ì„¤ì •

application.yml íŒŒì¼ì— H2 ë°ì´í„°ë² ì´ìŠ¤ì— í•„ìš”í•œ ì„¤ì • ì •ë³´ë¥¼ ì‘ì„±í•˜ì—¬ ê´€ë¦¬í•œë‹¤. 

```jsx
spring:
  # H2 ë°ì´í„°ë² ì´ìŠ¤ ì›¹ì½˜ì†” ì‚¬ìš© ì„¤ì •
  h2:
    console:
      enabled: true
      path: /h2-console
  # datasource ì„¤ì •(H2 ì‚¬ìš©)
  datasource:
    driverClassName: org.h2.Driver
    url: jdbc:h2:mem:testdb
    username: sa
    password:
  # JPAì˜ ë°ì´í„°ë² ì´ìŠ¤ í”Œë«í¼ ì§€ì •    
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
```

## 3. H2 ì›¹ì½˜ì†” ì‹¤í–‰

ì´ì œ IntelliJì—ì„œ bootRunì‹œì¼œ í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì›¹ì„œë²„ì— ë„ì›Œë³´ì. 

[http://localhost:8080/h2-console](http://localhost:8080/h2-console) ë¡œ ì ‘ì†í–ˆì„ ë•Œ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¤ë©´ ì„±ê³µì´ë‹¤.

<img src="https://user-images.githubusercontent.com/52793122/133824979-742c0ae7-eea7-4fbb-99db-3f23379f583b.png"  width="400" height="300"/>

[Connect] ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì•„ë˜ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤. 

![03](https://user-images.githubusercontent.com/52793122/133824986-98c99148-85d2-4dfe-b80a-9286a787ae1a.png)

## 4. ì˜ˆì œ í…Œì´ë¸” ìƒì„±

H2 ë°ì´í„°ë² ì´ìŠ¤ê¹Œì§€ ì—°ë™ë˜ì—ˆìœ¼ë‹ˆ í…Œì´ë¸”ì„ ìƒì„±í•´ë³´ì. 

ì±…ì—ì„œ ì•„ë˜ì™€ ê°™ì€ MEMBERë¼ëŠ” ì˜ˆì œ í…Œì´ë¸”ì„ ì£¼ê³  ìˆë‹¤. 

```jsx
CREATE TABLE MEMBER (
	ID VARCHAR(255) NOT NULL, --ì•„ì´ë””(ê¸°ë³¸í‚¤)
	NAME VARCHAR(255), --ì´ë¦„
	AGE INTEGER NOT NULL, --ë‚˜ì´
	PRIMARY KEY (ID)
);
```

ì½˜ì†”ì— ì…ë ¥ í›„ [Run] ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í…Œì´ë¸”ì´ ìƒì„±ëœë‹¤. 

![04](https://user-images.githubusercontent.com/52793122/133824990-b7ac4e5d-52ec-40fe-afee-e1871553cf29.png)

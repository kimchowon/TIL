# 6-1.다양한 의존관계 주입 방법

## 다양한 의존관계 주입 방법

- 생성자 주입
- setter 주입
- 필드 주입
- 일반 메서드 주입

## 생성자 주입

- 생성자를 통해 의존관계를 주입받는 방법
- 특징
    - 생성자 호출 시점에 딱 한 번만 호출되는 것이 보장된다.
    - 불변, 필수 의존관계에 사용
- 스프링 컨테이너가 객체를 생성하여 스프링 빈을 등록할 때 생성자를 호출하기 때문에, 스프링 빈 등록과 동시에 의존관계 주입도 함께 일어난다.
- 생성자가 딱 한 개만 있으면 생성자 위에 @Autowired를 생략해도 의존관계 주입이 된다.

## setter 주입

- setter라고 불리는 필드의 값을 변경하는 수정자 메서드를 통해서 의존관계를 주입하는 방법
- 특징
    - 선택, 변경 가능성이 있는 의존관계에 사용
        - 이미 의존 관계 주입이 되었는데 외부에서 setter를 호출하여 의존 관계를 변경할 수도 있다.

## 필드 주입

- 필드에 바로 주입하는 방법
    
    ```java
    @Component
    public class OrderServiceImpl implements OrderService {
    
        @Autowired
        private MemberRepository memberRepository;
    
        @Autowired
        private DiscountPolicy discountPolicy;
    ```
    

- 특징
    - 코드가 간결하지만 외부에서 변경이 불가능해서 테스트 하기 힘들다는 치명적인 단점이 있다.
        - 스프링(DI 프레임워크) 없이 순수한 자바 코드로 의조 관계 주입을 해줄 수가 없다.
        - 결국 setter를 만들어서 주입해줘야 한다.
- 운영 코드에서는 사용하지 않는 것을 권장.
    - 애플리케이션 실제 코드와 관계 없는 @SpringBootTest가 붙은 통합 테스트 코드에서 정도만 사용.
    - 통합 테스트는 실제 클래스들을 스프링 빈에 모두 올려놓고 실제 사용하여 테스트하는 것

## 일반 메서드 주입

- 일반 메서드를 통해서 주입
- 특징
    - 그냥 내가 임의로 생성한 아무 메서드 위에 @Autowired를 추가하여 의존 관계 주입
    - 한번에 여러 필드를 주입 받을 수 있다.
    - setter 주입과 같은 방식. 일반적으로 잘 사용하지 않는다.
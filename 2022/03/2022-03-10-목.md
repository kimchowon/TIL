# 6-3.생성자 주입을 선택하자.

setter 주입, 필드 주입을 사용하기 보다는 생성자 주입을 사용하는 것을 권장한다. 

## 생성자 주입을 권장하는 이유

### 1. 의존 관계 불변

- 의존 관계를 한번 주입하면  웬만해서는 애플리케이션이 종료될 때까지 의존 관계를 변경할 일이 없고 불변해야 하는 것이 맞다.
- setter 주입을 사용한다는 것은 외부에서 메소드 호출을 통해 의존 관계 변경을 허용하는 것이다.
    - 누군가 실수로 변경할 수도 있고, 변경하면 안되는 메소드를 열어두는 것은 좋은 설계 방법이 아니다.
- 생성자 주입은 객체를 생성할 때 딱 한 번만 호출되며 이후 호출될 일이 없으므로 불변하게 설계할 수 있다.

### 2. 누락 방지

- 프레임워크 없이 순수한 자바 코드로 테스트 코드를 작성할 때 개발자가 생성자로 객체만 생성하고 setter 메서드를 호출하지 않을 수도 있다.
    - 클래스에서 코드를 직접 까보지 않으면 setter 메소드로 주입하고 있는지 알 수가 없다.
    - 생성자 주입은 객체 생성할 때 바로 주입이 일어나므로 애플리케이션 실행 전에 컴파일 오류로 확인 가능하고 IDE에서 바로 어떤 값을 필수로 주입해야 하는지 알 수 있다.

### 3. final 키워드 사용

- 생성자 주입을 사용하면 필드에 final 키워드를 사용할 수 있다.
    - final 키워드를 붙이는 것은 한번 값이 할당되면 불변이라는 뜻
- 불변하게 사용할 수 있다는 장점이 있고 생성자 주입시에 혹시라도 값이 설정되지 않는 오류를 컴파일 시점에 알려준다.
    - final 키워드는 선언과 동시에 초기화해야하지만 생성자, static 블럭안에서의 초기화 정도까지는 허용한다.
    - 컴파일 오류는 가장 빠르고 좋은 오류
- 수정자 주입을 포함한 나머지 주입 방식은 모두 생성자 이후에 호출되므로 필드에 final 키워드를 사용할 수 없다.
- 오직 생성자 주입만 final 키워드를 사용할 수 있다.

## 정리

- 생성자 주입 방식을 사용하는 여러가지 이유들이 있지만, 프레임워크에 의존하지 않고 순수 자바 언어의 특징을 잘 살리는 방법이기도 하다.

- 생성자 주입 방식을 선택하고 가끔 옵션으로 변경할 상황이 있다면 setter 주입을 사용하면 된다. 필드 주입은 사용하지 않는 것이 좋다.

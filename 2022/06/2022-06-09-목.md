# Stream vs for

빠르게 훑기—

### Stream이란

- 연속된 데이터를 처리하는 오퍼레이션들의 모임
- 함수형 프로그래밍에서 시퀀스와 동일한 개념. 처리해야하는 task의 순서를 나열한 것

### Stream vs for

1) 표현 방식의 차이

- for문 → 코드 블럭
- stream → 함수형 프로그래밍(람다식), 메소드 참조

2) for문은 break, continue 키워드 사용 가능, Stream은 내부 연산할 때 사용 불가능

3) 가독성

- 가독성은 본인이 익숙한 정도에 따라 다르게 느껴지므로 취향 차이라고 할 수 있음
- 그래도 Stream이 가독성 측면에서 좋다는 말이 많으므로 예시를 들면 for문은 내부에 if 문의 개수가 많아지거나 뎁스가 깊어지면 인덴테이션이 많아짐. Stream은 메소드 체이닝으로 인덴테이션이 계속 들어갈 필요 없이 코드 작성 가능

4) 병렬 처리

- for문: Runnable을 구현하거나 Thread를 생성하여 병렬 처리를 위한 코드를 직접 작성해야함. 직접 구현을 해야하고 발생할 수 있는 동시성 문제를 고려해야 함.
- Stream: parallelStream 인터페이스 제공. 내부적으로 ForJoinPool을 사용하여 쓰레드들이 병렬 처리를 함.

5) 성능 차이

- 일반적으로 for문이 Stream 보다 속도는 빠름. 여러 이유가 있음. 첫번째는 for문은 Java 1버전부터 있었던 문법임. 때문에 비교적 나중에 나온 Stream보다 JVM에서의 최적화가 많이 이루어졌다고 함. 두번째는 오버헤드임. Stream은 사용하려면 Stream 객체를 생성해야 하고 수행이 끝나면 기존 데이터가 수정되는 것이 아니라 새로운 객체가 생성됨. 이런 생성 과정에서 오버헤드가 발생함. for문은 별도 객체를 생성하는 작업은 하지 않으므로 오버헤드가 발생할 일이 없음.
- 그렇지만 무조건 for문이 성능이 좋은 것은 아님. 일반 primitive 타입인 데이터로 연산을 수행할 경우 for문이 훨씬 성능이 좋음. 그런데 복잡한 비즈니스 로직이라던가 Wrapper 객체를 연산할 경우 둘의 성능 차이가 미미함. 예로 ArrayList를 들 수 있는데 ArrayList는 Integer라는 Wrapper 객체가 들어있는 Collection임. Integer Wrapper 객체를 박싱/언박싱 하는 과정에서 이미 많은 시간이 소요되므로 단순 Stream과 for문을 수행할 때 발생하는 성능 차이가 미미해짐.
- 그리고 요즘은 하드웨어의 성능이 좋기 때문에 소프트웨어를 개발할 때는 성능적인 측면을 많이 신경쓰기보다는 유지보수나 가독성 등을 고려하여 선택하기도 함.